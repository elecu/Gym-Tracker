<!doctype html>
<html lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gym Progress Tracker</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="loginGate" class="login-gate">
    <div class="login-card">
      <span class="login-mark">GT</span>
      <h2>Connect Google Drive</h2>
      <p>
        Sign in once to unlock your tracker and keep every photo and session
        backed up safely.
      </p>
      <button id="loginGateConnect" class="primary">Sign in with Google</button>
      <div id="loginGateStatus" class="login-status"></div>
    </div>
  </div>
  <header class="top-bar">
    <div class="brand">
      <span class="brand-mark">GT</span>
      <div>
        <h1>Gym Progress Tracker</h1>
        <p>Track machines, sets, and progress over time.</p>
      </div>
    </div>
    <nav class="tabs">
      <button class="tab is-active" data-tab="tracker">Tracker</button>
      <button class="tab" data-tab="settings">Settings</button>
    </nav>
  </header>

  <main>
    <section id="tracker" class="panel is-active">
      <div class="controls">
        <div class="group-filter">
          <span class="group-label">Muscle groups</span>
          <div class="group-options" id="groupFilters">
            <button class="chip is-active" data-scope="filter" data-group="legs" type="button" aria-pressed="true">Legs</button>
            <button class="chip" data-scope="filter" data-group="chest" type="button" aria-pressed="false">Chest</button>
            <button class="chip" data-scope="filter" data-group="shoulders" type="button" aria-pressed="false">Shoulders</button>
            <button class="chip" data-scope="filter" data-group="back" type="button" aria-pressed="false">Back</button>
            <button class="chip" data-scope="filter" data-group="abs" type="button" aria-pressed="false">Abs</button>
            <button class="chip" data-scope="filter" data-group="biceps" type="button" aria-pressed="false">Biceps</button>
            <button class="chip" data-scope="filter" data-group="triceps" type="button" aria-pressed="false">Triceps</button>
            <button class="chip chip-alias" data-scope="filter" data-alias="arms" data-targets="biceps,triceps" type="button" aria-pressed="false">Arms (Biceps + Triceps)</button>
          </div>
        </div>
        <div class="controls-actions">
          <label class="inline-toggle">
            <input id="compactToggle" type="checkbox" />
            Compact view
          </label>
          <button id="clearPins" class="ghost" type="button">Clear pins</button>
          <button id="addMachine" class="primary">+ Add machine</button>
          <span class="autosave" id="autosaveStatus">Autosave ready</span>
        </div>
      </div>

      <div id="machineList" class="machine-list"></div>
    </section>

    <section id="settings" class="panel">
      <div class="settings-card">
        <h2>Google Drive sync</h2>
        <p>
          Connect once to save your data and images in Google Drive. This is a
          live OAuth integration. You still need to enable the Drive API in
          Google Cloud.
        </p>
        <div class="settings-actions">
          <button id="connectDrive" class="primary">Connect Google Drive</button>
          <button id="disconnectDrive" class="ghost">Disconnect</button>
          <button id="syncDrive" class="ghost">Sync now</button>
        </div>
        <label class="toggle">
          <input id="autoSync" type="checkbox" checked />
          Auto sync after save
        </label>
        <div class="status" id="driveStatus">Not connected</div>
      </div>
    </section>
  </main>

  <dialog id="chartDialog" class="chart-dialog">
    <div class="chart-header">
      <h3 id="chartTitle">Progress chart</h3>
      <button id="closeChart" class="ghost">Close</button>
    </div>
    <canvas id="chartCanvas" width="640" height="360"></canvas>
  </dialog>

  <template id="machineTemplate">
    <article class="machine">
      <div class="machine-header">
        <div>
          <h3 class="machine-name" role="button" tabindex="0" aria-expanded="false">Unnamed machine</h3>
          <span class="machine-group">Group</span>
        </div>
        <div class="machine-actions">
          <button class="ghost pin-machine" type="button">Pin</button>
          <button class="ghost open-chart">Chart</button>
          <button class="ghost edit-machine">Edit</button>
          <button class="ghost remove-machine">Remove</button>
        </div>
      </div>
      <div class="machine-body">
        <div class="machine-media">
          <img class="machine-photo" alt="Machine photo" />
          <button class="ghost edit-photo" type="button">Add photo</button>
        </div>
        <div class="machine-details">
          <div class="sessions">
            <div class="sessions-header">
              <div>
                <h4>Sessions</h4>
                <p class="sessions-subtitle">Showing latest session</p>
              </div>
              <button class="ghost add-session">+ Add session</button>
            </div>
            <div class="session-tools">
              <label class="session-picker">
                <span>Session date</span>
                <input class="session-date-input" type="date" />
              </label>
              <div class="session-previous" aria-live="polite"></div>
            </div>
            <div class="session-list"></div>
          </div>
        </div>
      </div>
    </article>
  </template>

  <template id="sessionTemplate">
    <div class="session">
      <div class="session-meta">
        <span class="session-date"></span>
        <button class="ghost add-set">+ Add set</button>
        <button class="ghost remove-session">Remove</button>
      </div>
      <div class="set-table">
        <div class="set-row set-head">
          <span>Set</span>
          <span>Repetitions</span>
          <span>Weight</span>
          <span></span>
        </div>
        <div class="set-list"></div>
      </div>
    </div>
  </template>

  <template id="setTemplate">
    <div class="set-row">
      <span class="set-index"></span>
      <label class="set-field set-reps-field">
        <span class="set-label">Repetitions</span>
        <input class="set-reps" type="number" min="0" placeholder="0" inputmode="numeric" />
      </label>
      <div class="set-weight">
        <span class="set-label">Weight</span>
        <div class="set-weight-inputs">
          <input class="set-weight-value" type="number" min="0" placeholder="0" inputmode="numeric" />
          <select class="set-weight-unit">
            <option value="kg">kg</option>
            <option value="lb">lb</option>
          </select>
        </div>
      </div>
      <button class="ghost remove-set">Remove</button>
    </div>
  </template>

  <dialog id="editDialog" class="edit-dialog">
    <div class="edit-card">
      <div class="edit-header">
        <div>
          <h3>Edit machine details</h3>
          <p>Update the name and photo separately from the session log.</p>
        </div>
        <button id="closeEdit" class="ghost" type="button">Close</button>
      </div>
      <div class="edit-body">
        <label>
          Visible name
          <input id="editName" type="text" placeholder="Optional name" />
        </label>
        <div class="edit-groups">
          <span class="edit-label">Muscle groups</span>
          <div class="group-options group-options--edit">
            <button class="chip" data-scope="edit" data-group="legs" type="button" aria-pressed="false">Legs</button>
            <button class="chip" data-scope="edit" data-group="chest" type="button" aria-pressed="false">Chest</button>
            <button class="chip" data-scope="edit" data-group="shoulders" type="button" aria-pressed="false">Shoulders</button>
            <button class="chip" data-scope="edit" data-group="back" type="button" aria-pressed="false">Back</button>
            <button class="chip" data-scope="edit" data-group="abs" type="button" aria-pressed="false">Abs</button>
            <button class="chip" data-scope="edit" data-group="biceps" type="button" aria-pressed="false">Biceps</button>
            <button class="chip" data-scope="edit" data-group="triceps" type="button" aria-pressed="false">Triceps</button>
            <button class="chip chip-alias" data-scope="edit" data-alias="arms" data-targets="biceps,triceps" type="button" aria-pressed="false">Arms (Biceps + Triceps)</button>
          </div>
          <p class="edit-hint">Pick every group that should show this machine.</p>
        </div>
        <div class="edit-photo">
          <div class="edit-photo-preview">
            <img id="editPhotoPreview" alt="Machine photo preview" />
            <span id="editPhotoPlaceholder" class="edit-photo-placeholder">No photo yet</span>
          </div>
          <div class="edit-photo-actions">
            <label class="file-upload">
              <input id="editPhotoInput" type="file" accept="image/*" />
              Gallery
            </label>
            <label class="file-upload">
              <input id="editPhotoCameraInput" type="file" accept="image/*" capture="environment" />
              Camera
            </label>
            <button id="cropPhoto" class="ghost" type="button">Crop center</button>
            <button id="removePhoto" class="ghost" type="button">Remove photo</button>
          </div>
        </div>
      </div>
      <div class="edit-actions">
        <button id="saveEdit" class="primary" type="button">Save changes</button>
      </div>
    </div>
  </dialog>

  <div id="undoToast" class="undo-toast" role="status">
    <span id="undoMessage"></span>
    <button id="undoAction" class="ghost" type="button">Undo</button>
    <button id="undoDismiss" class="ghost" type="button">Close</button>
  </div>

  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="app.js"></script>
</body>
</html>
